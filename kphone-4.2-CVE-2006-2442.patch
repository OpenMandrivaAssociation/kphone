--- kphone/kphone/kphone.cpp.cve-2006-2442	2006-05-22 11:53:11.372464281 -0600
+++ kphone/kphone/kphone.cpp	2006-05-22 11:56:33.144925748 -0600
@@ -1,5 +1,8 @@
 #include <stdio.h>
 #include <stdlib.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+
 #include <qtimer.h>
 #include <qsettings.h>
 #include <qmenubar.h>
@@ -32,6 +35,8 @@ KPhone::KPhone( unsigned int listenport,
 		userPrefix = "_" + prefix + "_";
 	}
 	QSettings settings;
+	
+	umask(077);
 	Sip::setLocalAddress( settings.readEntry(
 		"/kphone/dissipate_addr", Sip::getLocalAddress() ) );
 	QString socketStr = settings.readEntry( "/kphone/General/SocketMode", "UDP" );
